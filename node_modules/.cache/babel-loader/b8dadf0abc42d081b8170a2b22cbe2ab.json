{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\manpe\\\\Documents\\\\year 2\\\\sem 1\\\\react projects\\\\multiplayer-tic-tac-toe\\\\src\\\\client\\\\components\\\\Game.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect, useRef } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport queryString from \"query-string\";\nimport io from \"socket.io-client\";\nimport Board from \"../components/Board\";\nimport \"./Game.css\";\nlet socket = io(\"http://localhost:8000\", {\n  withCredentials: true\n}); //const socket = io.connect('http://localhost:3000');\n\nconst Game = ({\n  location\n}) => {\n  _s();\n\n  const [yourTurn, setYourTurn] = useState(true);\n  const [squares, setSquares] = useState(Array(9).fill(null));\n  const [stepNumber, setStepNumber] = useState(0);\n  const [status, setStatus] = useState(\"It is X's turn\");\n  const [name, setName] = useState('');\n  const [room, setRoom] = useState(\"\");\n  const [users, setUsers] = useState(''); //const users = useRef();\n\n  const [flag, setFlag] = useState(0);\n  const [moves, setMoves] = useState(undefined);\n  const ENDPOINT = \"http://localhost:8000\"; //const users2 = users.slice();\n\n  useEffect(() => {\n    //const { name, room } = queryString.parse(location.search);\n    socket = io.connect(ENDPOINT);\n    const square = squares.slice();\n    setName(queryString.parse(location.search).name);\n    socket.emit(\"join\", {\n      name: queryString.parse(location.search).name,\n      room: queryString.parse(location.search).room\n    }, error => {\n      if (error) {\n        setFlag(1);\n        alert(error);\n      }\n    });\n    /*socket.on(\"move\", (data) => {\r\n      console.log(data.move);\r\n    });*/\n\n    setRoom(room);\n    socket.on('move', ({\n      move,\n      location,\n      name,\n      stepNumber\n    }) => {\n      square[location] = move;\n      setSquares(move);\n      setStepNumber(stepNumber + 1);\n      yourTurn ? setStatus(`It is ${name}'s turn`) : setStatus(`It is ${name}'s turn`);\n      stepNumber === 8 && setStatus(\"Tie\");\n      console.log(squares);\n      console.log(move); //console.log(turn);\n\n      console.log(name);\n      console.log(users.length);\n      console.log(stepNumber);\n    });\n    socket.on('turn', turn => {\n      setYourTurn(!turn);\n    });\n    socket.on('roomData', ({\n      users\n    }) => {\n      setUsers(users);\n\n      if (socket.id === user[1].id) {\n        setYourTurn(!yourTurn);\n      }\n\n      console.log(users);\n    });\n    socket.on('reset', ({\n      move,\n      turn,\n      stepNumber\n    }) => {\n      setSquares(move);\n      setYourTurn(turn);\n      setStepNumber(stepNumber);\n      setStatus(\"It is X's turn\");\n    });\n  }, [ENDPOINT, location.search]);\n  /*useEffect(() => {\r\n      socket.on('roomData', ({ users }) => {\r\n          setUsers(users);\r\n          console.log(users);\r\n      })\r\n  }, []);*/\n\n  const handleClick = i => {\n    const square = squares.slice();\n    const win = winner(square);\n    const tie = stepNumber === 8;\n\n    if (win || squares[i]) {\n      return;\n    }\n\n    if (yourTurn && squares[i] === null) {\n      square[i] = yourTurn ? \"X\" : \"O\";\n      setSquares(square);\n      setStepNumber(stepNumber + 1);\n      setYourTurn(!yourTurn); //!playerXTurn ? setStatus(\"It is X's turn\") : setStatus(\"It is O's turn\");\n    } //squares[i] === null ? (squares[i] = this.state.playerXTurn ? 'X' : 'O';) : this.setState({status: 'Please select another tile'});\n    //squares[i] === 'X' ? this.setState({playerXTurn: !playerXTurn}) : this.setState({playerXTurn: })\n\n\n    if (win) {\n      setStatus(\"\");\n    } else if (tie) {\n      setStatus(\"Tie\");\n    }\n\n    socket.emit(\"move\", {\n      name: queryString.parse(location.search).name,\n      room: queryString.parse(location.search).room,\n      move: square,\n      location: i,\n      stepNumber: stepNumber\n    });\n    socket.emit('turn', {\n      turn: yourTurn\n    });\n  };\n\n  const handleReset = () => {\n    setYourTurn(true);\n    setSquares(Array(9).fill(null));\n    const square = squares.slice();\n    setStepNumber(0);\n    setStatus(\"It is X's turn\");\n    socket.emit('reset', {\n      move: square,\n      turn: yourTurn,\n      stepNumber: stepNumber,\n      room: queryString.parse(location.search).room\n    });\n  };\n\n  const winner = squares => {\n    const win = [[0, 1, 2], [3, 4, 5], [6, 7, 8], [0, 3, 6], [1, 4, 7], [2, 5, 8], [0, 4, 8], [2, 4, 6]];\n\n    for (let i = 0; i < win.length; i++) {\n      const [a, b, c] = win[i];\n\n      if (squares[a] && squares[a] === squares[b] && squares[b] === squares[c]) {\n        return squares[a];\n      }\n    }\n\n    return null;\n  };\n\n  let victory;\n  const win = winner(squares);\n\n  if (win) {\n    victory = \"The winner is \" + (yourTurn ? \"O\" : \"X\");\n  }\n\n  console.log(queryString.parse(location.search).room);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"body\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"game\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(Board, {\n          onClick: i => handleClick(i),\n          squares: squares\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 186,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 187,\n          columnNumber: 11\n        }, this), win ? /*#__PURE__*/_jsxDEV(\"div\", {\n          id: \"feedback\",\n          className: \"status\",\n          children: victory\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 189,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"status\",\n          children: status\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 193,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 195,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"win\",\n          children: [(win || stepNumber === 9) && /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"reset\",\n            onClick: () => handleReset(),\n            children: \"Play Again?\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 199,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 203,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 204,\n            columnNumber: 13\n          }, this), (win || stepNumber === 9) && /*#__PURE__*/_jsxDEV(Link, {\n            to: \"/\",\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"button2\",\n              children: \"Exit\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 207,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 206,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 197,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 211,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 183,\n    columnNumber: 5\n  }, this);\n};\n\n_s(Game, \"ouZZJVGJ54GbRld/bvL8VFECOes=\");\n\n_c = Game;\nexport default Game;\n\nvar _c;\n\n$RefreshReg$(_c, \"Game\");","map":{"version":3,"sources":["C:/Users/manpe/Documents/year 2/sem 1/react projects/multiplayer-tic-tac-toe/src/client/components/Game.js"],"names":["React","useState","useEffect","useRef","Link","queryString","io","Board","socket","withCredentials","Game","location","yourTurn","setYourTurn","squares","setSquares","Array","fill","stepNumber","setStepNumber","status","setStatus","name","setName","room","setRoom","users","setUsers","flag","setFlag","moves","setMoves","undefined","ENDPOINT","connect","square","slice","parse","search","emit","error","alert","on","move","console","log","length","turn","id","user","handleClick","i","win","winner","tie","handleReset","a","b","c","victory"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport queryString from \"query-string\";\r\nimport io from \"socket.io-client\";\r\n\r\nimport Board from \"../components/Board\";\r\nimport \"./Game.css\";\r\n\r\nlet socket = io(\"http://localhost:8000\", {\r\n  withCredentials: true,\r\n});\r\n//const socket = io.connect('http://localhost:3000');\r\n\r\nconst Game = ({ location }) => {\r\n  const [yourTurn, setYourTurn] = useState(true);\r\n  const [squares, setSquares] = useState(Array(9).fill(null));\r\n  const [stepNumber, setStepNumber] = useState(0);\r\n  const [status, setStatus] = useState(\"It is X's turn\");\r\n  const [name, setName] = useState('');\r\n  const [room, setRoom] = useState(\"\");\r\n  const [users, setUsers] = useState('');\r\n  //const users = useRef();\r\n  const [flag, setFlag] = useState(0);\r\n  const [moves, setMoves] = useState(undefined);\r\n  const ENDPOINT = \"http://localhost:8000\";\r\n  //const users2 = users.slice();\r\n\r\n  useEffect(() => {\r\n    //const { name, room } = queryString.parse(location.search);\r\n\r\n    socket = io.connect(ENDPOINT);\r\n    const square = squares.slice();\r\n    \r\n    setName(queryString.parse(location.search).name);\r\n\r\n    socket.emit(\r\n      \"join\",\r\n      {\r\n        name: queryString.parse(location.search).name,\r\n        room: queryString.parse(location.search).room,\r\n      },\r\n      (error) => {\r\n        if (error) {\r\n          setFlag(1);\r\n          alert(error);\r\n        }\r\n      }\r\n    );\r\n    /*socket.on(\"move\", (data) => {\r\n      console.log(data.move);\r\n    });*/\r\n    setRoom(room);\r\n\r\n    socket.on('move', ({ move, location, name, stepNumber }) => {\r\n        square[location] = move;\r\n        setSquares(move);\r\n        setStepNumber(stepNumber + 1);\r\n        yourTurn ? setStatus(`It is ${name}'s turn`) : setStatus(`It is ${name}'s turn`);\r\n        stepNumber === 8 && setStatus(\"Tie\");\r\n        console.log(squares);\r\n        console.log(move);\r\n        //console.log(turn);\r\n        console.log(name);\r\n        console.log(users.length);\r\n        console.log(stepNumber);\r\n    });\r\n\r\n    socket.on('turn', (turn) => {\r\n      setYourTurn(!turn);\r\n    })\r\n\r\n    socket.on('roomData', ({ users }) => {\r\n        setUsers(users);\r\n        if(socket.id === user[1].id) {\r\n          setYourTurn(!yourTurn);\r\n        }\r\n        console.log(users);\r\n    })\r\n\r\n    socket.on('reset', ({move, turn, stepNumber }) => {\r\n        setSquares(move);\r\n        setYourTurn(turn);\r\n        setStepNumber(stepNumber);\r\n        setStatus(\"It is X's turn\")\r\n    })\r\n  }, [ENDPOINT, location.search]);\r\n\r\n    /*useEffect(() => {\r\n        socket.on('roomData', ({ users }) => {\r\n            setUsers(users);\r\n            console.log(users);\r\n        })\r\n    }, []);*/\r\n\r\n  const handleClick = (i) => {\r\n    const square = squares.slice();\r\n    const win = winner(square);\r\n    const tie = stepNumber === 8;\r\n\r\n    if (win || squares[i]) {\r\n      return;\r\n    }\r\n\r\n    if (yourTurn && (squares[i] === null)) {\r\n      square[i] = yourTurn ? \"X\" : \"O\";\r\n      setSquares(square);\r\n      setStepNumber(stepNumber + 1);\r\n      setYourTurn(!yourTurn);\r\n      //!playerXTurn ? setStatus(\"It is X's turn\") : setStatus(\"It is O's turn\");\r\n    }\r\n    //squares[i] === null ? (squares[i] = this.state.playerXTurn ? 'X' : 'O';) : this.setState({status: 'Please select another tile'});\r\n    //squares[i] === 'X' ? this.setState({playerXTurn: !playerXTurn}) : this.setState({playerXTurn: })\r\n\r\n    if (win) {\r\n      setStatus(\"\");\r\n    } else if (tie) {\r\n      setStatus(\"Tie\");\r\n    }\r\n\r\n    socket.emit(\"move\",  {\r\n      name: queryString.parse(location.search).name,\r\n      room: queryString.parse(location.search).room,\r\n      move: square,\r\n      location: i,\r\n      stepNumber: stepNumber\r\n    });\r\n\r\n    socket.emit('turn', {\r\n      turn: yourTurn\r\n    });\r\n\r\n    \r\n  };\r\n\r\n  const handleReset = () => {\r\n    setYourTurn(true);\r\n    setSquares(Array(9).fill(null));\r\n    const square = squares.slice();\r\n    setStepNumber(0);\r\n    setStatus(\"It is X's turn\");\r\n    socket.emit('reset', {\r\n        move: square,\r\n        turn: yourTurn,\r\n        stepNumber: stepNumber,\r\n        room: queryString.parse(location.search).room,\r\n    })\r\n  };\r\n\r\n  const winner = (squares) => {\r\n    const win = [\r\n      [0, 1, 2],\r\n      [3, 4, 5],\r\n      [6, 7, 8],\r\n      [0, 3, 6],\r\n      [1, 4, 7],\r\n      [2, 5, 8],\r\n      [0, 4, 8],\r\n      [2, 4, 6],\r\n    ];\r\n\r\n    for (let i = 0; i < win.length; i++) {\r\n      const [a, b, c] = win[i];\r\n      if (\r\n        squares[a] &&\r\n        squares[a] === squares[b] &&\r\n        squares[b] === squares[c]\r\n      ) {\r\n        return squares[a];\r\n      }\r\n    }\r\n    return null;\r\n  };\r\n\r\n  let victory;\r\n  const win = winner(squares);\r\n  if (win) {\r\n    victory = \"The winner is \" + (yourTurn ? \"O\" : \"X\");\r\n  }\r\n\r\n  console.log(queryString.parse(location.search).room);\r\n\r\n  return (\r\n    <div className='body'>\r\n      <div className='game'>\r\n        <div>\r\n          <Board onClick={(i) => handleClick(i)} squares={squares} />\r\n          <br />\r\n          {win ? (\r\n            <div id='feedback' className='status'>\r\n              {victory}\r\n            </div>\r\n          ) : (\r\n            <div className='status'>{status}</div>\r\n          )}\r\n          <br />\r\n\r\n          <div className='win'>\r\n            {(win || stepNumber === 9) && (\r\n              <button className='reset' onClick={() => handleReset()}>\r\n                Play Again?\r\n              </button>\r\n            )}\r\n            <br></br>\r\n            <br></br>\r\n            {(win || stepNumber === 9) && (\r\n              <Link to={\"/\"}>\r\n                <button className='button2'>Exit</button>\r\n              </Link>\r\n            )}\r\n          </div>\r\n          <br></br>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Game;"]},"metadata":{},"sourceType":"module"}